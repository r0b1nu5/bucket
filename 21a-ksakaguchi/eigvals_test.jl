using LinearAlgebra

include("tools.jl")

n = 3
L = n*diagm(0 => ones(n)) - ones(n,n)
th = pi/2*rand(n)
a = .5

J = jacobian(L,th,a)

(c11,c21,c31,c12,c22,c32,c13,c23,c33) = J

# 5
l2 = (-c12 - c13 - c21 - c23 - c31 - c32 - sqrt(c12^2 + c13^2 + c21^2 + c23^2 + c31^2 + c32^2 + 2*c12*c13 + 2*c12*c21 - 2*c12*c23 - 2*c12*c31 - 2*c12*c32 - 2*c13*c21 - 2*c13*c23 + 2*c13*c31 - 2*c13*c32 + 2*c21*c23 - 2*c21*c31 - 2*c21*c32 - 2*c23*c31 + 2*c23*c32 + 2*c31*c32))/2

l3 = (-c12 - c13 - c21 - c23 - c31 - c32 + sqrt(c12^2 + c13^2 + c21^2 + c23^2 + c31^2 + c32^2 + 2*c12*c13 + 2*c12*c21 - 2*c12*c23 - 2*c12*c31 - 2*c12*c32 - 2*c13*c21 - 2*c13*c23 + 2*c13*c31 - 2*c13*c32 + 2*c21*c23 - 2*c21*c31 - 2*c21*c32 - 2*c23*c31 + 2*c23*c32 + 2*c31*c32))/2

# 1
ls = eigvals(J)

# 2
u1 = [1/sqrt(2),-1/sqrt(2),0]
u2 = [1/sqrt(6),1/sqrt(6),-2/sqrt(6)]
J1 = [u1';u2']*J*[u1 u2]
ls1 = eigvals(J1)

# 3
(w11,w21,w12,w22) = J1

lw1 = (w11 + w22 - sqrt((w11-w22)^2 + 4*w12*w21))/2
lw2 = (w11 + w22 + sqrt((w11-w22)^2 + 4*w12*w21))/2

# 4
W11 = -c12-.5*c13-c21-.5*c23
W12 = (-3*c13+3*c23)/sqrt(12)
W21 = (-2*c12-c13+2*c21+c23-2*c31+2*c32)/sqrt(12)
W22 = -.5*c13-.5*c23-c31-c32

#@info "($w11,$W11) - ($w12,$W12) - ($w21,$W21) - ($w22,$W22)"

l4 = (-c12-.5*c13-c21-.5*c23-.5*c13-.5*c23-c31-c32 - sqrt((-c12-.5*c13-c21-.5*c23+.5*c13+.5*c23+c31+c32)^2 + 4*(-3*c13+3*c23)/sqrt(12)*(-2*c12-c13+2*c21+c23-2*c31+2*c32)/sqrt(12)))/2
l5 = (-c12-.5*c13-c21-.5*c23-.5*c13-.5*c23-c31-c32 + sqrt((-c12-.5*c13-c21-.5*c23+.5*c13+.5*c23+c31+c32)^2 + 4*(-3*c13+3*c23)/sqrt(12)*(-2*c12-c13+2*c21+c23-2*c31+2*c32)/sqrt(12)))/2

# 6
ll1 = (-c12-c13-c21-c23-c31-c32 - sqrt(c12*(c12+c13+c21-c23-c31-c32) + c13*(c12+c13-c21-c23+c31-c32) + c21*(c12-c13+c21+c23-c31-c32) + c23*(-c12-c13+c21+c23-c31+c32) + c31*(-c12+c13-c21-c23+c31+c32) + c32*(-c12-c13-c21+c23+c31+c32)))/2
ll2 = (-c12-c13-c21-c23-c31-c32 + sqrt(c12*(c12+c13+c21-c23-c31-c32) + c13*(c12+c13-c21-c23+c31-c32) + c21*(c12-c13+c21+c23-c31-c32) + c23*(-c12-c13+c21+c23-c31+c32) + c31*(-c12+c13-c21-c23+c31+c32) + c32*(-c12-c13-c21+c23+c31+c32)))/2

# 7 
ll3 = (-c12-c13-c21-c23-c31-c32 - sqrt((c12-c32)^2 + (c13-c23)^2 + (c21-c31)^2 + 2*(c12-c32)*(c13-c23) + 2*(c12-c32)*(c21-c31) - 2*(c13-c23)*(c21-c31)))/2
ll4 = (-c12-c13-c21-c23-c31-c32 + sqrt((c12-c32)^2 + (c13-c23)^2 + (c21-c31)^2 + 2*(c12-c32)*(c13-c23) + 2*(c12-c32)*(c21-c31) - 2*(c13-c23)*(c21-c31)))/2

@info "1: $(ls[1]), $(ls[2])"
@info "2: $(ls1[1]), $(ls1[2])"
@info "3: $lw1, $lw2"
@info "4: $l4, $l5"
@info "5: $l2, $l3"
@info "6: $ll1, $ll2"
@info "7: $ll3, $ll4"




